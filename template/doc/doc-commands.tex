% ensure that space is added after \latex
\let\oldlatex\latex
\renewcommand{\latex}{\oldlatex\xspace}

%% add package to index, when printed
%\let\OrigDemoPackage\demopackage
%\renewcommand{\demopackage}[1]{%
%\OrigDemoPackage{#1}%
%\index{package!#1}%
%}%
%
%% add command to index, when printed
%\let\OrigDemocs\democs
%\renewcommand{\democs}[1]{%
%\OrigDemocs{#1}%
%\index{command!\bs{}#1}%
%}%

% -------------------------------------------------
% \printCodeFromFile
% -------------------------------------------------
\newcounter{lstLastPage}
\newcounter{lstLastLine}
\setcounter{lstLastLine}{0}
\setcounter{lstLastPage}{0}
%
\newcommand{\printCodeFromFile}[3][]{%
\ifstrempty{#1}{}{%
  \setcounter{lstLastPage}{#1}%
}%
\setcounter{lstLastLine}{#2}%
%
\lstinputlisting[%
  firstnumber=\thelstLastPage,%
  firstline=\thelstLastPage,%
  lastline=\thelstLastLine,%
  nolol=true,
  style=lstStyleLaTeX]%
  {#3}%
%
\setcounter{lstLastPage}{#2}
\addtocounter{lstLastPage}{1}
}

% -------------------------------------------------
% \file and \labelfile
% -------------------------------------------------
% Code copied from http://tex.stackexchange.com/
%  questions/65639/how-to-create-my-on-ref-label-system/
% with later modifications.
% Thanks to Heiko Oberdiek for providing this answer !
% -------------------------------------------------
\DeclareUrlCommand{\FileName}{\urlstyle{tt}}

%%%
\newcounter{file}
% hyperref uses \theH<counter>
\providecommand*{\theHfile}{\thefile}

%% code from tex.stackexchange with the 
%% the help from Heiko Oberdiek.
\makeatletter
\newcommand*{\labelfile}[1]{%
  \StrSubstitute{#1}{/}{/,}[\IndexFileA]%
  \let\IndexFileB\@empty
  \expandafter
  \comma@parse@normalized\expandafter{\IndexFileA}\@AddFileEntry
  %
  \@bsphack
  \renewcommand*{\theHfile}{#1}%
  \refstepcounter{file}%
  \phantomsection
  \label{file:#1}%
  \index{files!\IndexFileB}%
  \@esphack  
}
\newcommand*{\@AddFileEntry}[1]{%
  \ifx\IndexFileB\@empty
    \def\IndexFileB{#1@\texttt{#1}}%
  \else
    \expandafter\def\expandafter\IndexFileB\expandafter{%
      \IndexFileB!%
      #1@\texttt{#1}%
    }%
  \fi
}
\makeatother


\newcommand*{\file}[1]{%
  \hyperref[file:#1]{\FileName{#1}}%
} 

\newcommand\cs[1]{\texttt{\textbackslash{}#1}}

