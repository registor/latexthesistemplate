\let\oldlatex\latex
\renewcommand{\latex}{\oldlatex\xspace}
\newcommand{\file}[1]{\texttt{#1}}

\let\OrigDemoPackage\demopackage
\renewcommand{\demopackage}[1]{
\OrigDemoPackage{#1}%
\index{package!#1}%
}%

\let\OrigDemocs\democs
\renewcommand{\democs}[1]{
\OrigDemocs{#1}%
\index{command!#1}%
}%


\newcounter{lstLastPage}
\newcounter{lstLastLine}
\setcounter{lstLastLine}{0}
\setcounter{lstLastPage}{0}
\newcommand{\printCodeFromFile}[3][]
{
\ifstrempty{#1}{}{%
  \setcounter{lstLastPage}{#1}
}
\setcounter{lstLastLine}{#2}
%
\lstinputlisting[%
  firstnumber=\thelstLastPage,%
  firstline=\thelstLastPage,%
  lastline=\thelstLastLine,%
  nolol=true,
  style=lstStyleLaTeX]%
  {#3}%
%
\setcounter{lstLastPage}{#2}
\addtocounter{lstLastPage}{1}
}

% =========================================================================
\chapter{Overview}

% =========================================================================
\chapter{Main file (LaTeXTemplate.tex)}

% -------------------------------------------------------------------------
\section{Code before the documentclass}

% ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
\subsection{magic shortcodes}
\printCodeFromFile{1}{LaTeXTemplate.tex}

% ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
\subsection{bug fix packages}
\printCodeFromFile[3]{6}{LaTeXTemplate.tex}

% -------------------------------------------------------------------------
\section{Documentclass}
In this template only classes from Koma-Script (Version 3) can be used.
Other classes would result in a non compiling template and are not supported therefore. 

In document class options some of the most important settings for the document are configured, such as paper size, font size and language of the document.
\printCodeFromFile{22}{LaTeXTemplate.tex}

% -------------------------------------------------------------------------
\section{Preamble (packages and settings)}
The code after \texttt{documentclass} and before the document starts is called preamble. All functionality and layout is loaded and configured there. The following sections show in which order things are loaded and configured.

% ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
\subsection{Packages that come first}
The following code loaded all packages that must be loaded before anything else. In this template this is necessary for all packages that are using by the template itself in control sequences.
\printCodeFromFile[27]{29}{LaTeXTemplate.tex}

% ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
\subsection{Encoding}
Selection of encoding of the LaTeX files and the encoding of the file system. The latter is primarily depended on the operating system.
\printCodeFromFile[35]{46}{LaTeXTemplate.tex}

% ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
\subsection{Packages, layout, fonts and custom commands}
Selection of fonts, packages (functionality), the style (layout) and custom commands that are required by the template.

TODO: add links to subfiles
\printCodeFromFile[52]{60}{LaTeXTemplate.tex}

% ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
\subsection{Configuration}
All the configuration code shown here is separated from the files \file{preamble/packages.tex} or \file{preamble/style.tex} because they are either system or target specific.
\medskip\\\noindent
%
Selection of link colors: The links can either be displayed in colors for a pdf document or be displayed in black for a print document.
\printCodeFromFile[69]{73}{LaTeXTemplate.tex}
%
Here possible options are selectable, which configure the way the pdf document is opened.
\printCodeFromFile[74]{87}{LaTeXTemplate.tex}
%
The backend and encodings for biblatex are configured in the following code.
\printCodeFromFile[89]{97}{LaTeXTemplate.tex}

% ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
\subsection{Custom definitions}
With the following files custom macros (\file{macros/newcommands.tex} and additional hypernation patterns \file{premabel/Hyphenation.tex} are loaded. 
\printCodeFromFile[103]{106}{LaTeXTemplate.tex}

% ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
\subsection{Execution of commands}
\label{sec:ExecutionOfCommands}
Several packages only work if their make-commands are executed. Examples are index, glossaries and such. Here these are grouped in the file \file{macros/makeCommands.tex}. 

\democs{listfiles} tells \latex to print all files loaded during compilation in a file list at the end of the log-file.
%
\printCodeFromFile[113]{115}{LaTeXTemplate.tex}

% ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
\subsection{Bibliography data}
With biblatex the bibliography files are loaded before the document starts. 
They are loaded with the command \democs{addbibresource} and the file is included without the \texttt{.bib} file extension. Multiple files bibliography files are added with multiple \democs{addbibresource} commands.
\printCodeFromFile[121]{129}{LaTeXTemplate.tex}

% -------------------------------------------------------------------------
\section{The document (the content)}
It start with \democs{begin\{document\}} and ends with \democs{end\{document\}}.
The code in-between includes all the content for the document. Nevertheless the code is filled with necessary style and settings commands.
\printCodeFromFile[145]{147}{LaTeXTemplate.tex}

\subsection{Acronyms}
If you want to use acronyms you can fill them in the file loaded here:
\printCodeFromFile[149]{150}{LaTeXTemplate.tex}
%
\subsection{Title page}
The page style and the page numbering for the title page is set up with this code
\printCodeFromFile[152]{154}{LaTeXTemplate.tex}
%
followed by the title page in file \file{content/title}.
\printCodeFromFile[157]{158}{LaTeXTemplate.tex}

\subsection{Abstract}
An abstract is common in phd thesis, but unusual in master and bachelor thesis. If you do not require an abstract just comment out the following lines.
\printCodeFromFile[162]{163}{LaTeXTemplate.tex}

\subsection{Declaration}
These lines load the document \file{content/Z-Declaration} in which you can state that the whole document is based on your ideas and written by only yourself. As far as I know this is required in bachelor and master thesis, but not part of phd-thesis. Comment out this line if you do not require it.
\printCodeFromFile[165]{166}{LaTeXTemplate.tex}

\subsection{Frontmatter}
The front pages of a thesis typically contain the table of contents followed by other lists. Here these are the symbol list, an acronym list and a glossary.

These lines only setup the page style and the line numbering for the front pages. The first line sets up as pages with headings defined by \texttt{srcheadings} and the line numbering is applied by the command \democs{frontmatter} in the second line.
\printCodeFromFile[168]{169}{LaTeXTemplate.tex}

\subsection{Table of contents}
The table of contents is inserted with \democs{tableofcontents}. Additionally it is added to the pdf bookmarks.
\printCodeFromFile[173]{175}{LaTeXTemplate.tex}

\subsection{Lists: acronym, symbols, glossaries}
These are loaded if the package for all these lists is loaded and the standard style, which requires the \demopackage{longtable} package is loaded. If you do not require all these lists comment those out that you do not want. The make commands required for building these lists were already executed, see \vref{sec:ExecutionOfCommands}. The styles of these lists are defined in file \file{preambel/style-glossaries.tex}.
\printCodeFromFile[177]{187}{LaTeXTemplate.tex}

\subsection{Main Document}
This is the part which contains all the content. It start with \democs{mainmatter}, which sets up the line numbering and is followed by a list of files loaded with \democs{include}. The latter is important to ensure that \democs{includeonly} works.
\printCodeFromFile[189]{197}{LaTeXTemplate.tex}

% =========================================================================
\chapter{Preamble files}

% =========================================================================
\chapter{How to list}